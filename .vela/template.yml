# Copyright (c) 2022 Target Brands, Inc. All rights reserved.
#
# Use of this source code is governed by the LICENSE file in this repository.

## Template Variables
# - .image      (default: "target/vela-kaniko:latest")
# - .pull       (default: true)
# - .log_level  (default: "info")
# - .auto_tag   (default: false)
# - .build_args (default: [])
# - .cache      (default: false)
# - .cache_repo (default: "")
# - .context    (default: ".")
# - .dockerfile (default: "Dockerfile")
# - .dry_run    (default: false)
# - .registry   (default: "")
# - .repo       (default: "")
# - .tags       (default: "")

metadata:
  template: true

steps:
  - name: docker_plugin_template
    image: {{ default "target/vela-kaniko:latest" .image }}
    pull: {{ default "true" .pull }}
    parameters:
      log_level: {{ default "info" .log_level }}
      auto_tag: {{ default "false" .auto_tag }}
      build_args: {{ default "[]" .build_args }}
      cache: {{ default "false" .cache }}
      cache_repo: {{ default "" .cache_repo }}
      context: {{ default "." .context }}
      dockerfile: {{ default "Dockerfile" .dockerfile }}
      dry_run: {{ default "false" .dry_run }}
      registry: {{ default "index.docker.io" .registry }}
      repo: {{ default "" .repo }}
      tags: {{ default "[ latest ]" .tags }}
